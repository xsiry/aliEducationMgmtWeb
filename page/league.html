<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
  <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
  <meta name="description" content="">
  <meta name="author" content="xsiry">
  <title></title>
  <!-- Bootstrap core CSS -->
  <link href="lib/bootstrap/bootstrap.min.css" rel="stylesheet" />
  <!-- Fullcalendar core CSS -->
  <link href="lib/fullcalendar/fullcalendar.min.css" rel="stylesheet" />
  <link href="lib/fullcalendar/fullcalendar.print.min.css" rel="stylesheet" media='print' />
  <link href="style.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="league.css">
</head>
<svg class="txp_svg_sprite txp_svg_sprite_head" display="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <symbol id="arrow_svg">
    <path d="M465.301422 515.736091l206.865441-206.865441c6.012947-6.012947 6.012947-15.763009 0-21.775956l-50.808176-50.808176c-6.012947-6.012947-15.763009-6.012947-21.776979 0l-267.463588 267.463588-2.133593 2.133593c-5.440919 5.440919-5.440919 14.262842 0 19.703761l1.889023 1.889023 266.855744 266.855744c6.701632 6.701632 17.107633 6.375198 23.727401-0.24457l48.178279-48.178279c6.859221-6.859221 6.859221-17.980513 0-24.840758L465.301422 515.736091z" p-id="4374" fill="#ffffff"></path>
  </symbol>
  <symbol id="arrow_right_svg">
    <path d="M558.698578 515.736091l-206.864418-206.865441c-6.012947-6.012947-6.012947-15.763009 0-21.775956l50.808176-50.808176c6.012947-6.012947 15.763009-6.012947 21.776979 0l267.463588 267.463588 2.133593 2.133593c5.440919 5.440919 5.440919 14.262842 0 19.703761l-1.889023 1.889023-266.855744 266.855744c-6.701632 6.701632-17.107633 6.375198-23.727401-0.24457l-48.178279-48.178279c-6.859221-6.859221-6.859221-17.980513 0-24.840758L558.698578 515.736091z" p-id="5204" fill="#ffffff"></path>
  </symbol>
  <symbol id="play_svg">
    <path d="M512 0C229.248 0 0 229.248 0 512s229.248 512 512 512 512-229.248 512-512S794.752 0 512 0zM512 960c-247.424 0-448-200.576-448-448s200.576-448 448-448 448 200.576 448 448S759.424 960 512 960z" p-id="2374" fill="#ffffff"></path>
    <path d="M384 256 768 512 384 768Z" p-id="2375" fill="#ffffff"></path>
  </symbol>
</svg>

<body>
  <section>
    <div class="left_conten">
      <nav class="x-navbar">
        <div class="x-menus">
          <ul>
            <li><a href="index.html">专区首页</a></li>
            <li class="active"><a href="league.html">E<sup>3</sup>联赛</a></li>
            <li><a href="beauty_live.html">美女直播</a></li>
          </ul>
        </div>
      </nav>
    </div>
    <div class="right_conten">
      <div class="row row_block league">
        <div class="col-md-6 league_images">
          <div class="top_popup">
            <div class="left_btn">
              <svg class="svg_icon" style="fill: #FFF;" viewBox="0 0 1024 1024">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#arrow_svg"></use>
              </svg>
            </div>
            <div class="right_btn">
              <svg class="svg_icon" style="fill: #FFF;" viewBox="0 0 1024 1024">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#arrow_right_svg"></use>
              </svg>
            </div>
            <!-- <div class="focus-num"><span class="current">1</span>/<span class="num">0</span></div> -->
            <div class="img_list">

            </div>
          </div>
          <div class="progress_bottom_win"></div>
        </div>
        <div id="league_videobox" class="col-md-6" style="width:50%;display: none;">
          <embed class='league_flash_src' src='' controls="volumelever" quality='high' width='100%' height='100%' allowScriptAccess='always' allowFullScreen='true' wmode='direct' bgcolor='#000000' flashvars='isAutoPlay=true&loop=true&playmode=2' type='application/x-shockwave-flash'>
        </div>
        <div class="col-md-6 league_schedule">
          <div id='calendar'></div>
          <div class="league_btn center-block">
            <a href="league_total_provincial.html">赛程安排</a>
          </div>
        </div>
      </div>

       <div class="row">
        <div class="pull-left" style="margin-top: 10px;">总赛程</div>
        <div class="pull-right">
          <a href="league_total_provincial.html" class="x-btn">
            分省赛程
            <svg class="svg_icon svg_icon_btn" viewBox="0 0 1024 1024">
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#arrow_right_svg"></use>
            </svg>
          </a>
        </div>
      </div>
      <div class="row row_block" style="z-index: 3;" id="clan_schedule_lsitid">

      </div>
      <div class="row row_block">
        <div class="col-md-12">
          <div id="videobox" class="col-md-6" style="padding: 0;height: 100%;">
            <!-- <embed class='flash_src' src='' controls="volumelever" quality='high' width='100%' height='100%' allowScriptAccess='always' allowFullScreen='true' wmode='direct' bgcolor='#000000' flashvars='loop=true&playmode=2' type='application/x-shockwave-flash'> -->
            <a class="play_flash" href="" target="_blank">
              <span class="imgbox">
                <b>
                  <svg class="svg_icon" viewBox="0 0 1024 1024">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#play_svg"></use>
                  </svg>
                </b>
                <img src="">
                </span>
            </a>
          </div>
          <div class="col-md-6" style="padding: 45px 20px 0 20px;position: relative;display: block;">
            <div style="position: absolute;line-height: 45px;font-weight: bold;font-size: 20px;top: 0px;">
              <a href="league_corps.html" style="color: #970101;">参赛战队</a>
            </div>
            <div style="position: absolute;right: 25px;top: 0;font-size: 16px;line-height: 48px;">
              <a href="league_corps.html">
                更多
              </a>
            </div>
            <div><a href="league_corps.html"><img class="cln_img" style="height: 250px;width: 90%;" src=""></a></div>
            <div class="cln_x_info" style="height:125px;overflow-y: auto;">
              <p>战队介绍: <span class="cln_intro"></span></p>
              <p>战术介绍: <span class="cln_tactics"></span></p>
              <p>胜率分析: <span class="cln_wnning"></span></p>
            </div>
            <input type='hidden' class="cln_id" value=""/>
            <input type='hidden' class="cln_standby" value=""/>
            <div class="cln_standby_btn">
            <button class="x-btn">支持(<span></span>)</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1262564689'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s13.cnzz.com/z_stat.php%3Fid%3D1262564689%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</body>
<script type="text/javascript" src="lib/fullcalendar/moment.min.js"></script>
<!-- JQuery core JS -->
<script src="lib/jquery/jquery-3.2.1.min.js"></script>
<!-- Bootstrap core JS -->
<script src="lib/bootstrap/bootstrap.min.js"></script>
<!-- Fullcalendar core JS -->
<script src="lib/fullcalendar/fullcalendar.min.js"></script>
<script src="lib/fullcalendar/locale/zh-cn.js"></script>
<script src="lib/ssofthelper.js"></script>
<script type="text/javascript">

var sec = 3;
var num = 0;
var numTotal = 4;
var interval;

$(document).ready(function() {
  $('.left_btn').css('transform', 'translate(-60px,0px)');
  $('.right_btn').css('transform', 'translate(60px,0px)');
  $.ajax({
    type: 'GET',
    url: '../query/table',
    dataType: 'json',
    data: {
      source: 'clan_schedule',
      qtype: 'select'
    },
    success: function(data) {
      if (data) {
        var calendarData = [];
        $.each(data, function(i, o) {
          var date = o.times.split(' ')[0];
          var time = o.times.split(' ')[1].substring(0, 5);
          calendarData.push({
            title: o.clan_name_a + ' VS ' + o.clan_name_b + ' ' + time,
            start: date,
            url: o.live_url
          });
        })
        $('#calendar').fullCalendar({
          header: {
            left: 'prev',
            center: 'title',
            right: 'next'
          },
          firstDay: 0,
          height: 400,
          contentHeight: 400,
          navLinks: false, // can click day/week names to navigate views
          editable: false,
          eventLimit: true, // allow "more" link when too many events
          events: calendarData
        });
      }
    }
  });

  $.ajax({
    type : 'GET',
    url : '../query/table',
    dataType : 'json',
    data : {
      source: 'gm_promotion',
      qtype: 'select',
      qhstr: JSON.stringify({qjson: [{type: 1},{status: 1}]})

    },
    success : function(data) {
      if (data.length > 0) {
        $('.league .league_images').hide();
        $('.league #league_videobox .league_flash_src').prop('src', data[0].imgurl);
        $('.league #league_videobox').show();
      }
    }
  });

  $.ajax({
    type : 'GET',
    url : '../query/table',
    dataType : 'json',
    data : {
      source: 'gm_promotion',
      qtype: 'select',
      qhstr: JSON.stringify({qjson: [{type: 0},{status: 1}]})

    },
    success : function(data) {
      if (data.length > 0) {
        var urlArry = data[0].imgurl.split(';');
        var aUrlArry = data[0].click.split(';');
        var titleArry = data[0].title.split(';');
        numTotal = urlArry.length;
        runImgsPlay();
        $.each(urlArry, function(i, url){
          var aBlock = '<a class="up_a img_a img_a_'+ i +'" href="'+ aUrlArry[i] +'"'+ ((i==0) ? 'style="z-index: 1;opacity: 1;-webkit-animation: img_act 1s linear forwards;"' : '') + 'target="_self">'
               + '<img class="up_img  img_'+ i +'" src="'+ '../' + url +'" alt="0">'
               + '<div class="i_title">'+ titleArry[i] +'</div></a>';
          $('div.img_list').append(aBlock);
        });
      }else {

      }
    }
  })

  function runImgsPlay() {
    $('.num').text(numTotal);
    interval = setInterval(queueingArr, sec * 1000);

    $('.progress_bottom_win').css('-webkit-animation', 'progress_bottom_act ' + sec + 's infinite linear');
    $('.progress_bottom_win').css('-moz-animation', 'progress_bottom_act ' + sec + 's infinite linear');
    $('.progress_bottom_win').css('-o-animation', 'progress_bottom_act ' + sec + 's infinite linear');
    $('.progress_bottom_win').css('-ms-animation', 'progress_bottom_act ' + sec + 's infinite linear');
    $('.progress_bottom_win').css('animation', 'progress_bottom_act ' + sec + 's infinite linear');

    $('.top_popup').hover(function() {
      clearInterval(interval);
      $('.left_btn').css('transform', 'translate(0px,0px)');
      $('.right_btn').css('transform', 'translate(0px,0px)');
      $('.progress_bottom_win').css('-webkit-animation', '');
      $('.progress_bottom_win').css('-moz-animation', '');
      $('.progress_bottom_win').css('-o-animation', '');
      $('.progress_bottom_win').css('-ms-animation', '');
      $('.progress_bottom_win').css('animation', '');
    }, function() {
      interval = setInterval(queueingArr, sec * 1000);
      $('.left_btn').css('transform', 'translate(-60px,0px)');
      $('.right_btn').css('transform', 'translate(60px,0px)');
      $('.progress_bottom_win').css('-webkit-animation', 'progress_bottom_act ' + sec + 's infinite linear');
      $('.progress_bottom_win').css('-moz-animation', 'progress_bottom_act ' + sec + 's infinite linear');
      $('.progress_bottom_win').css('-o-animation', 'progress_bottom_act ' + sec + 's infinite linear');
      $('.progress_bottom_win').css('-ms-animation', 'progress_bottom_act ' + sec + 's infinite linear');
      $('.progress_bottom_win').css('animation', 'progress_bottom_act ' + sec + 's infinite linear');
    });

    $('.left_btn').on('click', function() {
      num = num - 1;
      if (num < 0) num = numTotal - 1;
      choseImg(num, true);
    })

    $('.right_btn').on('click', function() {
      num = num + 1;
      if (num >= numTotal) num = 0;
      choseImg(num);
    })
  }

  $.ajax({
    type : 'GET',
    url : '../query/table',
    dataType : 'json',
    data : {
      source: 'clan_name',
      page: 1,
      pagesize: 2,
      sortname: 'cln_id',
      sortorder: 'DESC'
    },
    success : function(data) {
      if (data.Rows.length > 0) {
        $('.play_flash').prop('href', data.Rows[0].clickurl);
        $('.play_flash img').prop('src', '../' + data.Rows[0].videourl);
        $('.cln_img').prop('src', '../' + data.Rows[0].imgurl);
        $('.cln_intro').text(data.Rows[0].intro);
        $('.cln_tactics').text(data.Rows[0].tactics);
        $('.cln_wnning').text(data.Rows[0].wnning);
        $('.cln_id').val(data.Rows[0].cln_id);
        $('.cln_standby').val(data.Rows[0].standby);
        $('.cln_standby_btn span').text(data.Rows[0].standby);
      }
    }
  })

  $('button.x-btn').on('click', function() {
    $.ajax({
      type : 'POST',
      url : '../save/table',
      dataType : 'json',
      data : {
        actionname: 'clan_name',
        datajson: JSON.stringify({cln_id: $('.cln_id').val(), standby: parseInt($('.cln_standby').val()) + 1})
      },
      success : function(data) {
        $('button.x-btn').text('已支持').append('(<span>'+ (parseInt($('.cln_standby').val()) + 1)+'</span>)');
      }
    })
  })
   clanscheduleClick(1);
});

function queueingArr() {
  num++;
  if (num >= numTotal) num = 0;
  choseImg(num, false);
}

function choseImg(num, bool) {
  var upNum = bool ? num + 1 : num - 1;
  if (upNum < 0) upNum = numTotal - 1;
  if (upNum >= numTotal) upNum = 0;
  $('.img_a_' + upNum).css('z-index', 0);
  $('.img_a_' + upNum).css('opacity', 0);
  $('.img_a_' + upNum).css('-webkit-animation', '');
  $('.img_a_' + upNum).css('-moz-animation', '');
  $('.img_a_' + upNum).css('-o-animation', '');
  $('.img_a_' + upNum).css('-ms-animation', '');
  $('.img_a_' + upNum).css('animation', '');
  $('.img_a_' + num).css('z-index', 1);
  $('.img_a_' + num).css('opacity', 1);
  $('.img_a_' + num).css('-webkit-animation', 'img_act 1s linear forwards');
  $('.img_a_' + num).css('-moz-animation', 'img_act 1s linear forwards');
  $('.img_a_' + num).css('-o-animation', 'img_act 1s linear forwards');
  $('.img_a_' + num).css('-ms-animation', 'img_act 1s linear forwards');
  $('.img_a_' + num).css('animation', 'img_act 1s linear forwards');
  $('.current').text(num + 1);
}

function clanscheduleClick(page){
  $sHelper.AjaxPost("../tempalte/league/clanSchedule",{"page":page, "pagesize": 8,"dtpr_id":""},function(msg){
    $("#clan_schedule_lsitid").empty();
    $("#clan_schedule_lsitid").append(msg);
  });
}

</script>

</html>
